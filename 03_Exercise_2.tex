\chapter*{Exercise 2}

In order to contain the weight instability, we can amend the covariance matrix in order to “artificially” always make it useful and stable i.e. invertible. One method allowing us to end up with an invertible matrix is known as matrix shrinkage. \par\smallskip
Shrinkage works by computing a convex combination of a positively defined matrix with a semi-positively defined matrix, the result is a positively defined matrix which, by nature, is invertible. Furthermore, provided the weighting of the positively defined matrix is sufficient, the invert of combination not only exists, but is also stable. \par\smallskip
We use the following regularisation with $\lambda=0.2$ given to shrink the covariance matrix:
\begin{equation*}
\Sigma_s = \lambda F + (1-\lambda)\Sigma
\end{equation*}

Here $\Sigma$ is the semi-positively defined matrix whilst $F$ is going to be the positively defined one, namely:

\begin{itemize}
    \item $F_1=I_n$ The Identity Matrix
    \item $F_2=F_{\overline{\rho}}$ The Constant Correlation Matrix, first used by Ledoit and Wolf. Here we substitute the correlation coefficients in the covariance matrix between each pair of stocks with the average of the correlation coefficients.
\end{itemize}

\section*{Question 1}

In the first case we use the identity matrix $I_n$ and $\lambda=0.2$. We transform our estimate of $\Sigma$ and compute the inverse in order to solve the optimal weights. \\
We determine the optimal weights using both $\mu$ and $\Sigma$ estimates from the same sub-sample but using the shrunk covariance matrix $\Sigma_S$ to compute the optimal weights. In Figure \ref{fig2}, the left box-plot shows the resulting weight distribution for the first 20 stocks. The right box-plot is the plot from Figure \ref{fig1} also obtained using only the sub-sample but without shrinkage. \par\smallskip
Clearly, using a shrunk covariance matrix drastically improves the stability of the weights. However, this \emph{does not guarantee the optimality of the weights themselves}, we would have to test the performance of these new weights and compare said performance to that of the optimal portfolio derived from the full-sample.

\begin{figure}[H]
\includegraphics[width=14cm]{Boxplot_question_2_matrix_I.pdf}
\caption{Weight stability with shrinkage $F=I_n$}
\label{fig2}
\end{figure}

\section*{Question 2}

In the second case we use the constant correlation matrix $F_{\overline{\rho}}$ and $\lambda=0.2$. We also transform our estimate of $\Sigma$ and compute the inverse in order to solve the optimal weights. \\
The optimal weights are also derived from $\mu$ and $\Sigma$ estimates from the same sub-sample and using the new shrunk covariance matrix $\Sigma_S$ to compute the optimal weights. In Figure \ref{fig3}, the left box-plot shows the resulting weight distribution for the first 20 stocks. The right box-plot is the plot from Figure \ref{fig1} also obtained using only the sub-sample but without shrinkage. \par\smallskip
Just as in Figure \ref{fig2}, using a shrunk covariance matrix drastically improves the stability of the weights. This also \emph{does not guarantee the optimality of the weights themselves}, we would also have to test the performance of these new weights and compare said performance to that of the optimal portfolio derived from the full-sample.

\begin{figure}[H]
\includegraphics[width=14cm]{Boxplot_question_2_matrix_F.pdf}
\caption{Weight stability with shrinkage using $F=F_{\overline{\rho}}$}
\label{fig3}
\end{figure}

The obvious practical problem is which value to choose for the shrinkage constant. Any choice of $\lambda\;;\;\;0<\lambda<1$ would yield a compromise between $\Sigma$ and $F$. But this results in an infinite number of possible values for $\lambda$. 
\par\smallskip
Intuitively, there is an optimal shrinkage constant. It is the one that minimizes the expected distance between the shrinkage estimator and the true covariance matrix. \\
Another limit of shrinkage while using the constant correlation matrix is that the model would be inappropriate if assets came from different asset classes, such as stocks and bonds. \smallskip \\
\textit{(Ledoit \& Wolf, 2003 – Honey I Shrunk the Sample Covariance Matrix)}
\par\smallskip
Finally as mentioned previously, it is of vital importance to verify the performance of the weights obtained by using the shrunk covariance matrices: stable weights that do not yield an optimal or at least close-to-optimal performance do not present great interest.
